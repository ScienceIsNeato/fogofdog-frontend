#!/usr/bin/env sh
# Load environment variables for git hooks
# Try to source environment from common locations
if [ -f .envrc ]; then
  # Use direnv if available
  if command -v direnv >/dev/null 2>&1; then
    eval "$(direnv export sh)"
  else
    # Source .envrc manually if direnv not available
    set -a
    . ./.envrc
    set +a
  fi
elif [ -f .env ]; then
  # Load from .env file if it exists
  set -a
  . ./.env
  set +a
fi

# Fallback: check if SONAR_TOKEN is already set in environment
if [ -z "$SONAR_TOKEN" ]; then
  echo "‚ö†Ô∏è  SONAR_TOKEN not found in environment. Please set it in .envrc or .env file."
  echo "üí° Create .envrc with: export SONAR_TOKEN=your_token_here"
  exit 1
fi

npm run pre-commit:strict
