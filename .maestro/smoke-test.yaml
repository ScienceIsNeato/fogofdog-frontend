appId: com.fogofdog.app
---
# Smoke Test: Core app health check
#
# Validates the minimum viable app experience:
#   - App launches and lands on MapScreen (happy path)
#   - Map renders with fog overlay
#   - HUD buttons are present and responsive
#   - GPS movement causes map state change
#
# Preconditions: run_integration_tests.sh pre-seeds app state (onboarding
# completed, permissions granted). No conditionals needed.

# Set initial GPS before launch (establishes starting location)
- setLocation:
    latitude: 37.78825
    longitude: -122.4324

# Launch directly to map (zero UI gates)
- runFlow:
    file: shared/launch-to-map.yaml

# @checkpoint: 01-map-loaded
# @description: MapScreen visible after fresh launch. Fog overlay covers the area.
#   Location marker centered at initial GPS (37.788, -122.432). HUD buttons
#   (location, settings, tracking) visible. No onboarding overlay, no permission
#   dialogs, no loading spinners.
- takeScreenshot: 01-map-loaded

# Verify core HUD elements present
- assertVisible:
    id: 'location-button'
- assertVisible:
    id: 'settings-button'

# Test location button responds
- tapOn:
    id: 'location-button'
- waitForAnimationToEnd:
    timeout: 500

# Move ~500m south — should create a fog hole at the new location
- runFlow:
    file: shared/move-and-settle.yaml
    env:
      MOVE_LAT: "37.783750"
      MOVE_LON: "-122.4324"

# @checkpoint: 02-after-first-move
# @description: Map after 500m south movement. Two fog holes should be visible:
#   one at the starting location (37.788, -122.432) and one at the current
#   position (37.784, -122.432). Fog overlay still covers unexplored areas.
- takeScreenshot: 02-after-first-move

# Move again — 500m east — creates a third exploration point
- runFlow:
    file: shared/move-and-settle.yaml
    env:
      MOVE_LAT: "37.783750"
      MOVE_LON: "-122.4264"

# @checkpoint: 03-after-second-move
# @description: Map after second movement (500m east). Three fog holes visible
#   forming an L-shape. Map camera centered on current position (37.784, -122.426).
- takeScreenshot: 03-after-second-move

