appId: com.fogofdog.app
---
# Shared Flow: Move to GPS location and wait for map to settle
#
# Sets GPS to the given coordinates, waits for the map to process the
# location change, then taps the "center on me" button so the map
# camera follows.
#
# Input environment variables:
#   MOVE_LAT  - Target latitude (required)
#   MOVE_LON  - Target longitude (required)
#
# Usage:
#   - runFlow:
#       file: shared/move-and-settle.yaml
#       env:
#         MOVE_LAT: "37.78925"
#         MOVE_LON: "-122.4324"

- setLocation:
    latitude: ${MOVE_LAT}
    longitude: ${MOVE_LON}
# Proceed as soon as the location-button is interactable (already rendered;
# this confirms the location change propagated without a fixed delay).
- extendedWaitUntil:
    visible:
      id: 'location-button'
    timeout: 3000
# Re-center camera on new position
- tapOn:
    id: 'location-button'
    retryTapIfNoChange: false
# Brief settle for camera animation â€” 500ms is enough for the pan.
- waitForAnimationToEnd:
    timeout: 500
